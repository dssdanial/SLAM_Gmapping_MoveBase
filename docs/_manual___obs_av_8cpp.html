<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>SLAM_gmapping_movebase: src/Manual_ObsAv.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">SLAM_gmapping_movebase
   &#160;<span id="projectnumber">1</span>
   </div>
   <div id="projectbrief">A software architecture for the control of the robot in the environment.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">Manual_ObsAv.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Subscribes to /scan to detect obstacles and publishes to /cmd_vel to control the robot's velocity.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;ros/ros.h&quot;</code><br />
<code>#include &quot;geometry_msgs/Twist.h&quot;</code><br />
<code>#include &quot;sensor_msgs/LaserScan.h&quot;</code><br />
<code>#include &lt;termios.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Manual_ObsAv.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="_manual___obs_av_8cpp__incl.png" border="0" usemap="#src_2_manual___obs_av_8cpp" alt=""/></div>
<map name="src_2_manual___obs_av_8cpp" id="src_2_manual___obs_av_8cpp">
<area shape="rect" title="Subscribes to /scan to detect obstacles and publishes to /cmd_vel to control the robot&#39;s velocity." alt="" coords="215,5,383,32"/>
<area shape="rect" title=" " alt="" coords="5,80,84,107"/>
<area shape="rect" title=" " alt="" coords="109,80,285,107"/>
<area shape="rect" title=" " alt="" coords="309,80,498,107"/>
<area shape="rect" title=" " alt="" coords="523,80,607,107"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af5978fab9fa6dd4ced1c3a8ab1251f7b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#af5978fab9fa6dd4ced1c3a8ab1251f7b">getch</a> (void)</td></tr>
<tr class="memdesc:af5978fab9fa6dd4ced1c3a8ab1251f7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get non-blocking keyboard input.  <a href="_manual___obs_av_8cpp.html#af5978fab9fa6dd4ced1c3a8ab1251f7b">More...</a><br /></td></tr>
<tr class="separator:af5978fab9fa6dd4ced1c3a8ab1251f7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a98eed12f7274738a5ee23ee3ae47fc"><td class="memItemLeft" align="right" valign="top">float&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a8a98eed12f7274738a5ee23ee3ae47fc">Distance</a> (float obs_dist[], int val_min, int val_max)</td></tr>
<tr class="memdesc:a8a98eed12f7274738a5ee23ee3ae47fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the minimum value in a fixed range of an array.  <a href="_manual___obs_av_8cpp.html#a8a98eed12f7274738a5ee23ee3ae47fc">More...</a><br /></td></tr>
<tr class="separator:a8a98eed12f7274738a5ee23ee3ae47fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49fafbc5f138914847f7d2e562ce406"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#ac49fafbc5f138914847f7d2e562ce406">check_walls</a> (const sensor_msgs::LaserScan::ConstPtr &amp;msg)</td></tr>
<tr class="memdesc:ac49fafbc5f138914847f7d2e562ce406"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check the closest obstacle and decide what to do.  <a href="_manual___obs_av_8cpp.html#ac49fafbc5f138914847f7d2e562ce406">More...</a><br /></td></tr>
<tr class="separator:ac49fafbc5f138914847f7d2e562ce406"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4227105bb03c672faac7dea0c3a781e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a4227105bb03c672faac7dea0c3a781e9">choose_input</a> (char input)</td></tr>
<tr class="memdesc:a4227105bb03c672faac7dea0c3a781e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Associate the input from the keyboard with the correct command.  <a href="_manual___obs_av_8cpp.html#a4227105bb03c672faac7dea0c3a781e9">More...</a><br /></td></tr>
<tr class="separator:a4227105bb03c672faac7dea0c3a781e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f7d866eccdabe51bb16818a792618b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a7f7d866eccdabe51bb16818a792618b1">get_input</a> ()</td></tr>
<tr class="memdesc:a7f7d866eccdabe51bb16818a792618b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Display the menu and compute the velocity based on the input taken from the keyboard.  <a href="_manual___obs_av_8cpp.html#a7f7d866eccdabe51bb16818a792618b1">More...</a><br /></td></tr>
<tr class="separator:a7f7d866eccdabe51bb16818a792618b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="memdesc:a3c04138a5bfe5d72780bb7e82a18e627"><td class="mdescLeft">&#160;</td><td class="mdescRight">The main function.  <a href="_manual___obs_av_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">More...</a><br /></td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:adde9f51ddf0fb5c82c57b4075b6e9400"><td class="memItemLeft" align="right" valign="top"><a id="adde9f51ddf0fb5c82c57b4075b6e9400"></a>
ros::Publisher&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#adde9f51ddf0fb5c82c57b4075b6e9400">publisher</a></td></tr>
<tr class="memdesc:adde9f51ddf0fb5c82c57b4075b6e9400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global publisher. <br /></td></tr>
<tr class="separator:adde9f51ddf0fb5c82c57b4075b6e9400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accacf4e9263030d70ed79f8516c0eac5"><td class="memItemLeft" align="right" valign="top"><a id="accacf4e9263030d70ed79f8516c0eac5"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#accacf4e9263030d70ed79f8516c0eac5">velocity</a> = 0.2</td></tr>
<tr class="memdesc:accacf4e9263030d70ed79f8516c0eac5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variable for linear velocity. <br /></td></tr>
<tr class="separator:accacf4e9263030d70ed79f8516c0eac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0f8b5cad9317f1389ce5ab84b9a8b28"><td class="memItemLeft" align="right" valign="top"><a id="ad0f8b5cad9317f1389ce5ab84b9a8b28"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#ad0f8b5cad9317f1389ce5ab84b9a8b28">turn_velocity</a> = 0.5</td></tr>
<tr class="memdesc:ad0f8b5cad9317f1389ce5ab84b9a8b28"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variable for turn velocity. <br /></td></tr>
<tr class="separator:ad0f8b5cad9317f1389ce5ab84b9a8b28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5bcd692957aace1a21bfc205c67ec998"><td class="memItemLeft" align="right" valign="top"><a id="a5bcd692957aace1a21bfc205c67ec998"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a5bcd692957aace1a21bfc205c67ec998">linear</a> = 0</td></tr>
<tr class="memdesc:a5bcd692957aace1a21bfc205c67ec998"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variable for linear direction. <br /></td></tr>
<tr class="separator:a5bcd692957aace1a21bfc205c67ec998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ca7e9bd07214a8b29d24ef9b87b5a4f"><td class="memItemLeft" align="right" valign="top"><a id="a1ca7e9bd07214a8b29d24ef9b87b5a4f"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#a1ca7e9bd07214a8b29d24ef9b87b5a4f">angular</a> = 0</td></tr>
<tr class="memdesc:a1ca7e9bd07214a8b29d24ef9b87b5a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global variable for angular direction. <br /></td></tr>
<tr class="separator:a1ca7e9bd07214a8b29d24ef9b87b5a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa78c78a33ff8aacecd1105f94444acd3"><td class="memItemLeft" align="right" valign="top"><a id="aa78c78a33ff8aacecd1105f94444acd3"></a>
double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#aa78c78a33ff8aacecd1105f94444acd3">th</a> = 1</td></tr>
<tr class="memdesc:aa78c78a33ff8aacecd1105f94444acd3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global threshold for wall distance. <br /></td></tr>
<tr class="separator:aa78c78a33ff8aacecd1105f94444acd3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af113e9b4ca3af68972dfd3df47898c83"><td class="memItemLeft" align="right" valign="top"><a id="af113e9b4ca3af68972dfd3df47898c83"></a>
geometry_msgs::Twist&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_manual___obs_av_8cpp.html#af113e9b4ca3af68972dfd3df47898c83">vel</a></td></tr>
<tr class="memdesc:af113e9b4ca3af68972dfd3df47898c83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Global overall velocity. <br /></td></tr>
<tr class="separator:af113e9b4ca3af68972dfd3df47898c83"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Subscribes to /scan to detect obstacles and publishes to /cmd_vel to control the robot's velocity. </p>
<p>This node allows the user to drive the robot in the environment using the keyboard, while providing automatic obstacle avoidance. It reuses part of the code from the KeyboardDrive node for driving functionality. </p><dl class="section author"><dt>Author</dt><dd>Danial Sabzevari (<a href="#" onclick="location.href='mai'+'lto:'+'s52'+'17'+'544'+'@s'+'tud'+'en'+'ti.'+'un'+'ige'+'.i'+'t'; return false;">s5217<span style="display: none;">.nosp@m.</span>544@<span style="display: none;">.nosp@m.</span>stude<span style="display: none;">.nosp@m.</span>nti.<span style="display: none;">.nosp@m.</span>unige<span style="display: none;">.nosp@m.</span>.it</a>) </dd></dl>
<dl class="section version"><dt>Version</dt><dd>1.0 </dd></dl>
<dl class="section date"><dt>Date</dt><dd>01/06/2023 </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ac49fafbc5f138914847f7d2e562ce406"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49fafbc5f138914847f7d2e562ce406">&#9670;&nbsp;</a></span>check_walls()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void check_walls </td>
          <td>(</td>
          <td class="paramtype">const sensor_msgs::LaserScan::ConstPtr &amp;&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check the closest obstacle and decide what to do. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">msg</td><td>Contains the variables provided by the robot laser.</td></tr>
  </table>
  </dd>
</dl>
<p>This function checks where the closest obstacle is (front, left, or right of the robot). Based on the position of the closest obstacle, it modifies the velocity of the robot accordingly. </p>

</div>
</div>
<a id="a4227105bb03c672faac7dea0c3a781e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4227105bb03c672faac7dea0c3a781e9">&#9670;&nbsp;</a></span>choose_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void choose_input </td>
          <td>(</td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Associate the input from the keyboard with the correct command. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>The input value to associate with the correct command.</td></tr>
  </table>
  </dd>
</dl>
<p>This function modifies the velocity and turn velocity based on the input value. </p>

</div>
</div>
<a id="a8a98eed12f7274738a5ee23ee3ae47fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a98eed12f7274738a5ee23ee3ae47fc">&#9670;&nbsp;</a></span>Distance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float Distance </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>obs_dist</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val_min</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>val_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the minimum value in a fixed range of an array. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">obs_dist[]</td><td>The array. </td></tr>
    <tr><td class="paramname">val_min</td><td>The index from which to start the search. </td></tr>
    <tr><td class="paramname">val_max</td><td>The index at which to stop the search. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The minimum value in the range.</dd></dl>
<p>This function compares the elements of the selected range and returns the minimum value. </p>

</div>
</div>
<a id="a7f7d866eccdabe51bb16818a792618b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f7d866eccdabe51bb16818a792618b1">&#9670;&nbsp;</a></span>get_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_input </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Display the menu and compute the velocity based on the input taken from the keyboard. </p>
<p>This function displays the menu with the available commands for modifying the direction and velocity. It calls the choose_input function to compute the new velocity based on the user's input and assigns the computed velocity to the vel variable. </p>

</div>
</div>
<a id="af5978fab9fa6dd4ced1c3a8ab1251f7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5978fab9fa6dd4ced1c3a8ab1251f7b">&#9670;&nbsp;</a></span>getch()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getch </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get non-blocking keyboard input. </p>
<dl class="section return"><dt>Returns</dt><dd>The input character from the keyboard.</dd></dl>
<p>This function is used to avoid pressing Enter after giving an input from the keyboard, as part of teleop_twist_keyboard.cpp. </p>

</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The main function. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">argc</td><td>An integer argument count of the command line arguments. </td></tr>
    <tr><td class="paramname">argv</td><td>An argument vector of the command line arguments. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>An integer 0 upon success.</dd></dl>
<p>The main function initializes the ROS node, subscribes to /scan topic, and publishes to /cmd_vel topic. It enters a while loop to continuously get user input for controlling the robot. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
